import{u as T,c as $,a as i,b as B}from"./index.esm.9ad0c25f.js";import{g as G,r as R,u as U,a as S,Q as j,j as r,R as v,b as s,C as u,F as o,c as w,B as V}from"./index.0caedde8.js";const Q=()=>{var h,g,p,b,x,F,C,f,D,E,N,y;const c=G(),[q,m]=R.exports.useState(!1);U(`/user/list/${c==null?void 0:c.sub}`);const{data:d}=U("/trainingArea/list"),e=T({initialValues:{nome:"",fotoUrl:"",descricao:"",areaDeFormacaoId:""},validationSchema:$({nome:i().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl:B().test("isImage","Por favor selecione um arquivo de imagem v\xE1lido!",a=>a?!0:a&&["image/png","image/jpg","image/jpeg","image/gif"].includes(a.type)),descricao:i().required("Este campo \xE9 obrigat\xF3rio"),areaDeFormacaoId:i().required("Este campo \xE9 obrigat\xF3rio")}),onSubmit:async a=>{var t,I;try{m(!0);const l=new FormData;l.append("file",a==null?void 0:a.fotoUrl[0]);const n=await L(l);n&&(a={...a,fotoUrl:n==null?void 0:n.id},await S.post("/course/post",a)&&(j.success("Curso cadastrado com sucesso"),e.resetForm()))}catch(l){j.error((I=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:I.message)}finally{setTimeout(()=>{m(!1)},4e3)}}});async function L(a){return(await S.post("/file",a)).data}return r(v,{children:s(u,{children:[r(u.Header,{className:"d-flex justify-content-between",children:r("div",{className:"header-title",children:r("h4",{className:"card-title",children:" Cadastrar Curso"})})}),r(u.Body,{children:s(o,{onSubmit:e.handleSubmit,encType:"multipart/form-data",children:[s(v,{children:[s(w,{md:"6",className:"mb-3",children:[r(o.Label,{htmlFor:"validationDefault04",children:"Area de Forma\xE7\xE3o"}),s(o.Select,{id:"areaDeFormacaoId",name:"areaDeFormacaoId",required:!0,onChange:e.handleChange,children:[r("option",{defaultChecked:!0,children:"Selecione um area de forma\xE7\xE3o"}),d==null?void 0:d.map(a=>r("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.nome},a==null?void 0:a.id))]}),((h=e==null?void 0:e.touched)==null?void 0:h.areaDeFormacaoId)&&((g=e==null?void 0:e.errors)==null?void 0:g.areaDeFormacaoId)?r("label",{className:"mt-1 text-danger",children:(p=e==null?void 0:e.errors)==null?void 0:p.areaDeFormacaoId}):null,s(o.Group,{className:"mb-3 form-group mt-2",children:[r(o.Label,{htmlFor:"exampleFormControlTextarea1",children:"Descri\xE7\xE3o"}),r(o.Control,{as:"textarea",id:"descricao",value:e.values.descricao,name:"descricao",onChange:e.handleChange,rows:"5"}),((b=e==null?void 0:e.touched)==null?void 0:b.descricao)&&((x=e==null?void 0:e.errors)==null?void 0:x.descricao)?r("label",{className:"mt-1 text-danger",children:(F=e==null?void 0:e.errors)==null?void 0:F.descricao}):null]})]}),s(w,{md:"6",className:"mb-3",children:[r(o.Label,{md:"6",htmlFor:"validationDefault01",children:"Nome do Curso"}),r(o.Control,{type:"text",id:"nome",name:"nome",value:e.values.nome,onChange:e.handleChange,required:!0}),((C=e==null?void 0:e.touched)==null?void 0:C.nome)&&((f=e==null?void 0:e.errors)==null?void 0:f.nome)?r("label",{className:"mt-1 text-danger",children:(D=e==null?void 0:e.errors)==null?void 0:D.nome}):null,s(o.Group,{className:"mb-3 form-group mt-2",children:[r(o.Label,{className:"custom-file-input",children:"Carregar imagem"}),r(o.Control,{type:"file",id:"fotoUrl",name:"fotoUrl",accept:"image/png, image/jpg, image/jpeg, image/gif",onChange:a=>{var t;e.setFieldValue("fotoUrl",(t=a==null?void 0:a.currentTarget)==null?void 0:t.files)}}),((E=e==null?void 0:e.touched)==null?void 0:E.fotoUrl)&&((N=e==null?void 0:e.errors)==null?void 0:N.fotoUrl)?r("label",{className:"mt-1 text-danger",children:(y=e==null?void 0:e.errors)==null?void 0:y.fotoUrl}):null]})]})]}),r(o.Group,{children:r(V,{variant:"btn btn-primary",type:"submit",disabled:q,children:"Cadastrar"})})]})})]})})};export{Q as default};
