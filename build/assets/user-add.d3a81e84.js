import{r as c,g as $,u as j,a as D,Q as L,j as r,R as T,b as l,C as m,F as s,c as f,B}from"./index.0caedde8.js";import{u as G,c as V,a as t,b as O}from"./index.esm.9ad0c25f.js";const H=c.exports.memo(()=>{var p,g,b,x,C,F,v,N,y,I,E,S,U,q,w;c.exports.useState(!1);const d=$(),[R,h]=c.exports.useState(!1);j(`/user/list/${d==null?void 0:d.sub}`);const{data:u}=j("/province/list"),e=G({initialValues:{nome:"",email:"",senha:"",fotoUrl:"",provinciaId:"",tipoUsuario:"ADMINISTRADOR_PROVINCIAL"},validationSchema:V({nome:t().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl:O().test("isImage","Por favor selecione um arquivo de imagem v\xE1lido!",a=>a?!0:a&&["image/png","image/jpg","image/jpeg","image/gif"].includes(a.type)),senha:t().required("Este campo  \xE9 obrigat\xF3rio"),email:t().required("Este campo  \xE9 obrigat\xF3rio"),provinciaId:t().required("Este campo  \xE9 obrigat\xF3rio"),tipoUsuario:t().required("Este campo  \xE9 obrigat\xF3rio")}),onSubmit:async a=>{var n,A;try{h(!0);const o=new FormData;o.append("file",a==null?void 0:a.fotoUrl[0]);const i=await P(o);i&&(a={...a,fotoUrl:i==null?void 0:i.id},await D.post("/user/post",a)&&(L.success("Administrador cadastrado com sucesso"),e.resetForm()))}catch(o){L.error((A=(n=o==null?void 0:o.response)==null?void 0:n.data)==null?void 0:A.message)}finally{setTimeout(()=>{h(!1)},4e3)}}});async function P(a){return(await D.post("/file",a)).data}return r(c.exports.Fragment,{children:r(T,{children:l(m,{children:[r(m.Header,{className:"d-flex justify-content-between",children:r("div",{className:"header-title",children:r("h4",{className:"card-title",children:"Cadastrar Administrador (Provincial)"})})}),r(m.Body,{children:r(s,{onSubmit:e==null?void 0:e.handleSubmit,encType:"multipart/form-data",children:l(T,{className:"mb-3",children:[l(f,{md:"6",className:"mb-3",children:[r(s.Label,{htmlFor:"validationCustom05",children:"Nome"}),r(s.Control,{onChange:e.handleChange,name:"nome",value:e.values.nome,type:"text",id:"nome",required:!0}),((p=e==null?void 0:e.touched)==null?void 0:p.nome)&&((g=e==null?void 0:e.errors)==null?void 0:g.nome)?r("label",{className:"mt-1 text-danger",children:(b=e==null?void 0:e.errors)==null?void 0:b.nome}):null,l(s.Group,{className:"mb-3 form-group mt-2",children:[r(s.Label,{htmlFor:"exampleFormControlTextarea1",children:"Email"}),r(s.Control,{type:"text",id:"email",value:e.values.email,name:"email",onChange:e.handleChange}),((x=e==null?void 0:e.touched)==null?void 0:x.email)&&((C=e==null?void 0:e.errors)==null?void 0:C.email)?r("label",{className:"mt-1 text-danger",children:(F=e==null?void 0:e.errors)==null?void 0:F.email}):null]}),r(s.Label,{htmlFor:"validationCustom05",children:"Provincia"}),l(s.Select,{id:"provinciaId",name:"provinciaId",required:!0,onChange:e.handleChange,children:[r("option",{defaultChecked:!0,children:"Selecione uma provincia"}),u==null?void 0:u.map(a=>r("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.nome},a==null?void 0:a.id))]}),((v=e==null?void 0:e.touched)==null?void 0:v.provinciaId)&&((N=e==null?void 0:e.errors)==null?void 0:N.provinciaId)?r("label",{className:"mt-1 text-danger",children:(y=e==null?void 0:e.errors)==null?void 0:y.provinciaId}):null]}),l(f,{md:"6",className:"mb-3",children:[l(s.Group,{className:"mb-3 form-group mt-2",children:[r(s.Label,{className:"custom-file-input",children:"Carregar imagem"}),r(s.Control,{type:"file",id:"fotoUrl",name:"fotoUrl",onChange:a=>{var n;e.setFieldValue("fotoUrl",(n=a==null?void 0:a.currentTarget)==null?void 0:n.files)}}),((I=e==null?void 0:e.touched)==null?void 0:I.fotoUrl)&&((E=e==null?void 0:e.errors)==null?void 0:E.fotoUrl)?r("label",{className:"mt-1 text-danger",children:(S=e==null?void 0:e.errors)==null?void 0:S.fotoUrl}):null]}),l(s.Group,{className:"mb-3 form-group mt-2",children:[r(s.Label,{htmlFor:"exampleFormControlTextarea1",children:"Senha"}),r(s.Control,{type:"password",id:"senha",value:e.values.senha,name:"senha",onChange:e.handleChange}),((U=e==null?void 0:e.touched)==null?void 0:U.senha)&&((q=e==null?void 0:e.errors)==null?void 0:q.senha)?r("label",{className:"mt-1 text-danger",children:(w=e==null?void 0:e.errors)==null?void 0:w.senha}):null]})]}),r("div",{className:"col-12",children:r(B,{type:"submit",disabled:R,children:"Cadastrar"})})]})})})]})})})});H.displayName="FuncionarioAdd";export{H as default};
