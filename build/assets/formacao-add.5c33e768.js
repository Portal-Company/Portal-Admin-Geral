import{g as T,r as $,u as S,a as j,Q as q,j as r,R as v,b as l,C as u,F as o,c as w,B as A}from"./index.0caedde8.js";import{u as B,c as V,a as n,b as G}from"./index.esm.9ad0c25f.js";const Q=()=>{var g,h,p,b,x,C,F,E,N,y,I,f;const i=T(),[D,m]=$.exports.useState(!1);S(`/user/list/${i==null?void 0:i.sub}`);const{data:d}=S("/category/list"),e=B({initialValues:{nome:"",fotoUrl:"",descricao:"",categoriaId:""},validationSchema:V({nome:n().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl:G().test("isImage","Por favor selecione um arquivo de imagem v\xE1lido!",a=>a?!0:a&&["image/png","image/jpg","image/jpeg","image/gif"].includes(a.type)),descricao:n().required("Este campo \xE9 obrigat\xF3rio"),escolaId:n().required("Este campo \xE9 obrigat\xF3rio"),categoriaId:n().required("Este campo \xE9 obrigat\xF3rio")}),onSubmit:async a=>{var s,U;try{m(!0);const t=new FormData;t.append("file",a==null?void 0:a.fotoUrl[0]);const c=await L(t);c&&(a={...a,fotoUrl:c==null?void 0:c.id},await j.post("/trainingArea/post",a)&&(q.success("Area de Forma\xE7\xE3o cadastrada com sucesso"),e.resetForm()))}catch(t){q.error((U=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:U.message)}finally{setTimeout(()=>{m(!1)},4e3)}}});async function L(a){return(await j.post("/file",a)).data}return r(v,{children:l(u,{children:[r(u.Header,{className:"d-flex justify-content-between",children:r("div",{className:"header-title",children:r("h4",{className:"card-title",children:"Cadastrar Area de Forma\xE7\xE3o"})})}),r(u.Body,{children:r(o,{onSubmit:e==null?void 0:e.handleSubmit,encType:"multipart/form-data",children:l(v,{className:"mb-3",children:[l(w,{md:"6",className:"mb-3",children:[r(o.Label,{htmlFor:"validationCustom05",children:"Nome"}),r(o.Control,{onChange:e.handleChange,name:"nome",value:e.values.nome,type:"text",id:"nome",required:!0}),((g=e==null?void 0:e.touched)==null?void 0:g.nome)&&((h=e==null?void 0:e.errors)==null?void 0:h.nome)?r("label",{className:"mt-1 text-danger",children:(p=e==null?void 0:e.errors)==null?void 0:p.nome}):null,r(o.Label,{htmlFor:"validationCustom05",children:"Categoria"}),l(o.Select,{id:"categoriaId",name:"categoriaId",required:!0,onChange:e.handleChange,children:[r("option",{defaultChecked:!0,children:"Selecione um Categoria"}),d==null?void 0:d.map(a=>r("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.nome},a==null?void 0:a.id))]}),((b=e==null?void 0:e.touched)==null?void 0:b.categoriaId)&&((x=e==null?void 0:e.errors)==null?void 0:x.categoriaId)?r("label",{className:"mt-1 text-danger",children:(C=e==null?void 0:e.errors)==null?void 0:C.categoriaId}):null,l(o.Group,{className:"mb-3 form-group mt-2",children:[r(o.Label,{htmlFor:"exampleFormControlTextarea1",children:"Descri\xE7\xE3o"}),r(o.Control,{as:"textarea",id:"descricao",value:e.values.descricao,name:"descricao",onChange:e.handleChange,rows:"5"}),((F=e==null?void 0:e.touched)==null?void 0:F.descricao)&&((E=e==null?void 0:e.errors)==null?void 0:E.descricao)?r("label",{className:"mt-1 text-danger",children:(N=e==null?void 0:e.errors)==null?void 0:N.descricao}):null]})]}),r(w,{md:"6",className:"mb-3",children:l(o.Group,{className:"mb-3 form-group mt-2",children:[r(o.Label,{className:"custom-file-input",children:"Carregar imagem"}),r(o.Control,{type:"file",accept:"image/png, image/jpg, image/jpeg, image/gif",id:"fotoUrl",name:"fotoUrl",onChange:a=>{var s;e.setFieldValue("fotoUrl",(s=a==null?void 0:a.currentTarget)==null?void 0:s.files)}}),((y=e==null?void 0:e.touched)==null?void 0:y.fotoUrl)&&((I=e==null?void 0:e.errors)==null?void 0:I.fotoUrl)?r("label",{className:"mt-1 text-danger",children:(f=e==null?void 0:e.errors)==null?void 0:f.fotoUrl}):null]})}),r("div",{className:"col-12",children:r(A,{type:"submit",disabled:D,children:"Cadastrar"})})]})})})]})})};export{Q as default};
