import{r as m,g as M,u as I,a as d,m as R,Q as h,j as a,R as z,b as s,C as u,F as o,c as B,B as O}from"./index.0caedde8.js";import{u as P,c as Q,a as p,b as _}from"./index.esm.9ad0c25f.js";const J=m.exports.memo(()=>{var N,b,x,v,C,F,S,y,U,f,A,w,E,j,T,$,L,G;m.exports.useState(!1);const n=M(),[V,g]=m.exports.useState(!1),{data:l}=I(`/user/list/${n==null?void 0:n.sub}`);I("/province/list"),console.log(l);const e=P({initialValues:{nome:l==null?void 0:l.nome,email:l==null?void 0:l.email,senhaActual:"",confirmarSenhaNova:"",senhaNova:"",fotoUrl:l==null?void 0:l.fotoUrl,tipoUsuario:"ADMINISTRADOR_GERAL"},validationSchema:Q({nome:p().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl:_().test("isImage","Por favor selecione um arquivo de imagem v\xE1lido!",r=>r?!0:r&&["image/png","image/jpg","image/jpeg","image/gif"].includes(r.type)),email:p().required("Este campo  \xE9 obrigat\xF3rio"),tipoUsuario:p().required("Este campo  \xE9 obrigat\xF3rio")}),onSubmit:async r=>{var i,q;try{if(g(!0),(r==null?void 0:r.fotoUrl)===(l==null?void 0:l.fotoUrl))await d.put(`/user/put/${l==null?void 0:l.id}`,r)&&(e.resetForm(),R(`/user/list/${n==null?void 0:n.sub}`),h.success("Administrador actualizado com sucesso"));else{const t=new FormData;t.append("file",r==null?void 0:r.fotoUrl[0]);const c=await H(t);c&&(r={...r,fotoUrl:c==null?void 0:c.id},await d.put(`/user/put/${l==null?void 0:l.id}`,r)&&(e.resetForm(),R(`/user/list/${n==null?void 0:n.sub}`),h.success("Administrador actualizado com sucesso")))}}catch(t){h.error((q=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:q.message)}finally{setTimeout(()=>{g(!1)},4e3)}}});async function H(r){return(await d.post("/file",r)).data}return a(m.exports.Fragment,{children:a(z,{children:s(u,{children:[a(u.Header,{className:"d-flex justify-content-between",children:a("div",{className:"header-title",children:a("h4",{className:"card-title",children:"Actualizar Administrador"})})}),a(u.Body,{children:a(o,{onSubmit:e==null?void 0:e.handleSubmit,encType:"multipart/form-data",children:s(z,{className:"mb-3",children:[s(B,{md:"6",className:"mb-3",children:[a(o.Label,{htmlFor:"validationCustom05",children:"Nome"}),a(o.Control,{onChange:e.handleChange,name:"nome",value:e.values.nome,type:"text",id:"nome",required:!0}),((N=e==null?void 0:e.touched)==null?void 0:N.nome)&&((b=e==null?void 0:e.errors)==null?void 0:b.nome)?a("label",{className:"mt-1 text-danger",children:(x=e==null?void 0:e.errors)==null?void 0:x.nome}):null,s(o.Group,{className:"mb-3 form-group mt-2",children:[a(o.Label,{htmlFor:"exampleFormControlTextarea1",children:"Email"}),a(o.Control,{type:"text",id:"email",value:e.values.email,name:"email",onChange:e.handleChange}),((v=e==null?void 0:e.touched)==null?void 0:v.email)&&((C=e==null?void 0:e.errors)==null?void 0:C.email)?a("label",{className:"mt-1 text-danger",children:(F=e==null?void 0:e.errors)==null?void 0:F.email}):null]})]}),s(B,{md:"6",className:"mb-3",children:[s(o.Group,{className:"mb-3 form-group mt-2",children:[a(o.Label,{className:"custom-file-input",children:"Carregar imagem"}),a(o.Control,{accept:"image/png, image/jpg, image/jpeg, image/gif",type:"file",id:"fotoUrl",name:"fotoUrl",onChange:r=>{var i;e.setFieldValue("fotoUrl",(i=r==null?void 0:r.currentTarget)==null?void 0:i.files)}}),((S=e==null?void 0:e.touched)==null?void 0:S.fotoUrl)&&((y=e==null?void 0:e.errors)==null?void 0:y.fotoUrl)?a("label",{className:"mt-1 text-danger",children:(U=e==null?void 0:e.errors)==null?void 0:U.fotoUrl}):null]}),s(o.Group,{className:"mb-3 form-group mt-2",children:[a(o.Label,{htmlFor:"exampleFormControlTextarea1",children:"Senha"}),a(o.Control,{type:"password",id:"senha",value:e.values.senha,name:"senha",onChange:e.handleChange}),((f=e==null?void 0:e.touched)==null?void 0:f.senha)&&((A=e==null?void 0:e.errors)==null?void 0:A.senha)?a("label",{className:"mt-1 text-danger",children:(w=e==null?void 0:e.errors)==null?void 0:w.senha}):null]}),s(o.Group,{className:"mb-3 form-group mt-2",children:[a(o.Label,{htmlFor:"exampleFormControlTextarea1",children:"Nova Senha"}),a(o.Control,{type:"password",id:"senhaNova",value:e.values.senhaNova,name:"senhaNova",onChange:e.handleChange}),((E=e==null?void 0:e.touched)==null?void 0:E.senhaNova)&&((j=e==null?void 0:e.errors)==null?void 0:j.senhaNova)?a("label",{className:"mt-1 text-danger",children:(T=e==null?void 0:e.errors)==null?void 0:T.senhaNova}):null]}),s(o.Group,{className:"mb-3 form-group mt-2",children:[a(o.Label,{htmlFor:"exampleFormControlTextarea1",children:"Confirmar Senha"}),a(o.Control,{type:"password",id:"confirmarSenhaNova",value:e.values.confirmarSenhaNova,name:"confirmarSenhaNova",onChange:e.handleChange}),(($=e==null?void 0:e.touched)==null?void 0:$.confirmarSenhaNova)&&((L=e==null?void 0:e.errors)==null?void 0:L.confirmarSenhaNova)?a("label",{className:"mt-1 text-danger",children:(G=e==null?void 0:e.errors)==null?void 0:G.confirmarSenhaNova}):null]})]}),a("div",{className:"col-12",children:a(O,{type:"submit",disabled:V,children:"Actualizar"})})]})})})]})})})});J.displayName="FuncionarioAdd";export{J as default};
